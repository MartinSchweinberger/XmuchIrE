---
title: "X-much CXN in IrE - Part 2: Data processing"
author: "Anonymous"
date: "`r format(Sys.time(), '%Y-%m-%d')`"
output:
  word_document
bibliography: bibliography.bib
link-citations: yes
---

This document focuses on the use of the X-much construction in Irish English. 

This part of the analysis performs the data processing and extracting examples of the X-much construction.

# Session preparation

cleaning the workspace, loading packages, setting options, and defining paths.

```{r xmprep_2_01}
# clean workspace
rm(list=ls(all=T))
# load packages
library(tidyverse)
library(here)
library(readxl)
library(flextable)
library(quanteda)
# setting options
options(stringsAsFactors = F)
# set paths
cpath <- "D:\\Uni\\Korpora\\Edited\\GloWbe_postagged"
```

# Extract and process texts from corpus

Extract sample and save it to disc

```{r xm_2_03}
# list files
cfiles <- list.files(cpath, pattern = ".txt", full.names = T)
# load texts
texts <- unlist(sapply(cfiles, function(x){
  filename <- str_remove_all(x, ".*/")
  filename <- str_remove_all(filename, ".txt")
   x <- readLines(x)
   x <- paste0(x, collapse = " ")
   x <- str_split(str_replace_all(x, "##", "~~~##"), "~~~")
   x <- unlist(x)
}))
# inspect data
str(texts)
```

Clean data

```{r xm_2_07}
# simplify names
names(texts) <- str_remove_all(names(texts), ".*/")
names(texts) <- str_replace_all(names(texts), ".txt", "_")
# clean texts
texts <- texts[which(texts != "")]
# inspect
str(texts)
```


extract instances of much

```{r xm_2_07}
# kwic
kwics <- kwic(x = texts[1:10000], 
              window = 10,
              pattern = "much", 
              valuetype = "regex",
              case_insensitive = F)
# filtering
kwics_clean <- kwics %>%
  mutate(pre_short = str_remove_all(pre, ".* "),
         post_short = str_squish(post),
         post_short = str_replace_all(post_short, "/ ", "/"),
         post_short = str_replace(post_short, " ", "_"),
         post_short = str_replace(post_short, " ", "_"),
         post_short = str_remove_all(post_short, " .*"),
         post_short = str_replace_all(post_short, ".*jj.*", "hit"),
         post_short = str_replace_all(post_short, ".*rrr.*", "hit"),
         post_short = str_replace_all(post_short, ".*rgr.*", "hit")) %>%
  filter(pre_short == "jj",
         post_short != "hit") %>%
  as.data.frame()
# inspect
head(kwics_clean)
```

clean kwics

```{r xm_1_07}
# kwic
kwics <- kwic
# inspect
head(kwics)
```



***

The END

***

